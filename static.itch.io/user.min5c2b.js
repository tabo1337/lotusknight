(()=>{var T,m=T=window.$,h=window.I,v=h.ReferrerTracker||(h.ReferrerTracker=function(){function r(){}return r.MAX_ITEMS=20,r.get_cookie=function(){return window.Cookies.getJSON("itchio_refs")||[]},r.write_cookie=function(e){return h.set_cookie("itchio_refs",e,{expires:14})},r.has_ref=function(e,n){var t,u,o,l,_,p;for(n=+n,_=r.get_cookie(),o=0,l=_.length;o<l;o++)if(p=_[o],u=p[0],t=p[1],u===e&&t===n)return!0;return!1},r.push=function(e,n,t){var u,o;if(t&&t.length>0){for(n=+n,o=function(){var l,_,p,f;for(p=this.get_cookie(),f=[],l=0,_=p.length;l<_;l++)u=p[l],!(u[0]===e&&u[1]===n)&&f.push(u);return f}.call(r),h.in_dev&&console.log("pushing referrer",[e,n,t]),o.unshift([e,n,t]);o.length>r.MAX_ITEMS;)o.pop();return r.write_cookie(o)}},r}()),b=function(r,e){var n;return n=function(t){var u,o,l,_;if(t.closest(".game_author").length||(u=t.closest("[data-game_id]").data("game_id"))&&v.push("game",u,e(t)),!t.closest(".sale_author").length&&(o=t.closest("[data-sale_id]"),l=o.data("sale_id")))return _=o.data("sale_type"),v.push(_,l,e(t))},r.on("mouseup",".game_cell a, .sale_row a, .leader_game a",function(t){if(!(t.which>3))return n(m(t.currentTarget))}),r.on("i:track_link",function(t){return n(m(t.target))})};I.UserPage=function(){r.prototype.sticky_selector=".profile_column, .game_column";function r(e,n){var t;this.opts=n,this.el=$(e),this.opts.queue_url&&(t=window.parent)!=null&&t.postMessage({page_url:window.location.href,queue_url:this.opts.queue_url},"*"),this.setup_grid(),this.setup_tracking(),this.opts.ac&&I.setup_affiliate_code(this.opts.ac)}return r.prototype.setup_grid=function(){var e,n;return e=function(t){return function(){return $(window).width()<500?10:20}}(this),new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".mode_grid .user_game_grid",cell_margin:e,min_columns:2}),this.grid=new I.GameGrid(this.el.find(".user_game_grid"),{sizer:!1,show_popups:!1}),new I.GameGridSizer({el:this.el.find(".inner_column.profile_content"),container_selector:".game_grid_widget.game_list",cell_margin:e,expected_size:250,min_columns:2}),n=$(".purchased_games, .collections"),n.lazy_images({}),new I.GameCells(n)},r.prototype.setup_tracking=function(){return b(this.el,function(e){return function(){return"user:"+e.opts.user_id}}(this)),I.tracked_links(this.el,"user")},r}(),I.UserUserTools=function(){function r(e){this.el=$(e),I.tracked_links(this.el,"view_user","user_tools"),I.has_follow_button(this.el),setTimeout(function(n){return function(){return n.el.removeClass("hidden")}}(this),200)}return r}(),I.UserLayout=function(){function r(e){this.el=$(e),$(".user_page_wrap").max_height($(".header_widget").outerHeight(!0)||0),new I.UserUserTools(this.el.find(".user_tools"))}return r}();var y=window.React,M=window.ReactDOM,k=window.ReactDOMFactories,S=window.ReactTransitionGroup,U=window.PropTypes,G=window.classNames,D=window.R;y||h.libs.react.done(function(){return y=window.React,M=window.ReactDOM,k=window.ReactDOMFactories,S=window.ReactTransitionGroup,U=window.PropTypes,G=window.classNames,D=window.R}),I.libs.react.done(function(){var r,e,n,t,u,o,l,_,p;return e=k,l=e.select,o=e.option,_=e.strong,u=e.label,t=e.div,n=e.a,r=R.package("User"),p=PropTypes,r("ToolTags",{getInitialState:function(){return{selected_tags:$.extend({},this.props.default_tags)}},componentDidMount:function(){},tags_by_id:function(){return this._tags_by_id?this._tags_by_id:(this._tags_by_id={},this.props.tag_groups.forEach(function(f){return function(a){return a.tags.forEach(function(i){return i.group=a,f._tags_by_id[""+i.id]=i})}}(this)),this._tags_by_id)},select_tag:function(f){var a,i,c,g,s,d,w;for(d=$.extend({},this.state.selected_tags),w=this.tags_by_id()[f],s=w.group.tags,i=0,c=s.length;i<c;i++)g=s[i],delete d[g.id];return d[w.id]=!0,this.setState({selected_tags:d}),typeof(a=this.props).on_select_tags=="function"?a.on_select_tags(d):void 0},unselect_group:function(f){var a,i,c,g,s,d;for(s=$.extend({},this.state.selected_tags),g=f.tags,i=0,c=g.length;i<c;i++)d=g[i],delete s[d.id];return this.setState({selected_tags:s}),typeof(a=this.props).on_select_tags=="function"?a.on_select_tags(s):void 0},render:function(){var f;return f=this.props.tag_groups.map(function(a){return function(i){var c,g;if(g=i.tags.find(function(s){if(a.state.selected_tags[s.id])return!0}),c=i.tags.map(function(s){return{name:s.name,value:s.id}}),!!c.length)return c.unshift({name:"Any",value:""}),R.Forms.SimpleSelect({key:i.slug,name:i.slug,value:(g!=null?g.id:void 0)||"default",render_current_option:function(s){return s.value===""?i.name:_({},s.name)},onChange:function(s){var d;return d=a.tags_by_id()[s],d?a.select_tag(d.id):a.unselect_group(i)},options:c})}}(this)),this.enclose({},u({},"Filter games"),f,$.isEmptyObject(this.state.selected_tags)?void 0:t({className:"clear_area"},n({href:"#",onClick:function(a){return function(i){var c;return i.preventDefault(),a.setState({selected_tags:{}}),typeof(c=a.props).on_select_tags=="function"?c.on_select_tags({}):void 0}}(this)},"Clear filters")))}})})})();
